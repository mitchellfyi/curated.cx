#!/usr/bin/env ruby
# Quality check script - runs all code quality tools

require "bundler/inline"

puts "ğŸ” Running code quality checks..."
puts "=" * 50

# Run RuboCop
puts "\nğŸ“ Running RuboCop..."
system("bundle exec rubocop")

# Run Brakeman security scan
puts "\nğŸ”’ Running Brakeman security scan..."
system("bundle exec brakeman -q --format plain")

# Run RSpec tests
puts "\nğŸ§ª Running RSpec tests..."
system("bundle exec rspec")

# Run Annotaterb to keep models annotated
puts "\nğŸ“ Annotating models..."
system("bundle exec annotaterb models")

# Check i18n translations
puts "\nğŸŒ Checking i18n translations..."
puts "  Missing translations:"
system("bundle exec i18n-tasks missing")
puts "  Unused translations:"
system("bundle exec i18n-tasks unused")
puts "  Normalizing translation files:"
system("bundle exec i18n-tasks normalize")

# Run accessibility tests specifically
puts "\nâ™¿ Running accessibility tests..."
system("bundle exec rspec spec/system/accessibility_spec.rb")

# Run Rails best practices (if available)
if system("command -v rails_best_practices > /dev/null")
  puts "\nğŸ“‹ Running Rails Best Practices..."
  system("rails_best_practices .")
end

puts "\nâœ… Quality checks complete!"
