#!/usr/bin/env bash
# Switch between fast and comprehensive overcommit configurations

set -e

case "${1:-}" in
  "fast"|"f")
    echo "üöÄ Switching to FAST pre-commit hooks"
    ln -sf .overcommit-fast.yml .overcommit.yml
    echo "‚úÖ Now using fast configuration:"
    echo "   ‚Ä¢ RuboCop (staged files only)"
    echo "   ‚Ä¢ ERB Lint (staged files only)"
    echo "   ‚Ä¢ Basic syntax checks"
    echo "   ‚Ä¢ Tests moved to pre-push"
    echo ""
    echo "üí° For full checks: ./script/dev/quality"
    ;;
  "minimal"|"m")
    echo "‚ö° Switching to MINIMAL pre-commit hooks"
    ln -sf .overcommit-minimal.yml .overcommit.yml
    echo "‚úÖ Now using minimal configuration:"
    echo "   ‚Ä¢ YAML syntax only"
    echo "   ‚Ä¢ Trailing whitespace only"
    echo "   ‚Ä¢ Everything else moved to pre-push"
    echo ""
    echo "‚ö†Ô∏è  Make sure to run full checks before pushing!"
    ;;
  "full"|"comprehensive"|"c")
    echo "üîç Switching to COMPREHENSIVE pre-commit hooks"
    ln -sf .overcommit-comprehensive.yml .overcommit.yml
    echo "‚úÖ Now using comprehensive configuration"
    echo "   ‚Ä¢ All quality gates enabled"
    echo "   ‚Ä¢ Tests run on every commit"
    echo "   ‚Ä¢ Anti-pattern detection"
    echo ""
    echo "‚ö†Ô∏è  Warning: This will be slower"
    ;;
  "status"|"s")
    if [[ -L .overcommit.yml ]]; then
      target=$(readlink .overcommit.yml)
      echo "üìä Current configuration: $target"
      case "$target" in
        *"minimal"*) echo "‚ö° Using MINIMAL mode (~1s)" ;;
        *"fast"*) echo "üöÄ Using FAST mode (~3-8s)" ;;
        *) echo "üîç Using COMPREHENSIVE mode (~30-60s)" ;;
      esac
    else
      echo "üìä Using default configuration"
    fi
    ;;
  *)
    echo "üîß Overcommit Configuration Manager"
    echo ""
    echo "Usage: $0 [minimal|fast|full|status]"
    echo ""
    echo "Options:"
    echo "  minimal, m       Ultra-fast hooks (~1s) - syntax only"
    echo "  fast, f          Fast hooks (~3-8s) - essential checks"
    echo "  full, c          Comprehensive hooks (~30-60s) - all checks"
    echo "  status, s        Show current configuration"
    echo ""
    echo "Current status:"
    $0 status
    echo ""
    echo "üí° Recommendations:"
    echo "   ‚Ä¢ Use 'minimal' for rapid iteration/debugging"
    echo "   ‚Ä¢ Use 'fast' for daily development"
    echo "   ‚Ä¢ Use 'full' before important commits"
    echo "   ‚Ä¢ CI always runs comprehensive validation"
    ;;
esac