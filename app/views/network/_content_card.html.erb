<%# Content card for cross-network feed with site attribution %>
<article class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow">
  <div class="p-6">
    <div class="flex items-center justify-between mb-3">
      <%# Site badge with link %>
      <% if content_item.site_name.present? %>
        <% site_url = content_item.site_primary_hostname.present? ? "https://#{content_item.site_primary_hostname}" : "#" %>
        <%= link_to site_url,
                    class: "inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",
                    target: "_blank",
                    rel: "noopener",
                    title: t('network.feed.view_on_site', site: content_item.site_name) do %>
          <%= content_item.site_name %>
        <% end %>
      <% end %>

      <%# Published time %>
      <% if content_item.published_at %>
        <time class="text-sm text-gray-500 whitespace-nowrap" datetime="<%= content_item.published_at.iso8601 %>">
          <%= t('time.ago', time: time_ago_in_words(content_item.published_at)) %>
        </time>
      <% end %>
    </div>

    <%# Title with external link %>
    <h3 class="text-lg font-semibold text-gray-900 mb-2">
      <%= link_to content_item.title || t('feed.content.untitled'),
                  content_item.url_canonical,
                  target: "_blank",
                  rel: "noopener noreferrer",
                  class: "hover:text-blue-600 transition-colors" %>
    </h3>

    <%# Summary %>
    <% summary = content_item.ai_summary.presence || content_item.summary.presence || content_item.description %>
    <% if summary.present? %>
      <p class="text-gray-600 text-sm line-clamp-3 mb-3">
        <%= truncate(summary, length: 150) %>
      </p>
    <% end %>

    <%# Topic tags %>
    <% if content_item.topic_tags.any? %>
      <div class="flex flex-wrap gap-1 mb-3">
        <% content_item.topic_tags.first(3).each do |tag| %>
          <%= badge(tag.titleize, :gray) %>
        <% end %>
      </div>
    <% end %>

    <%# Source and engagement %>
    <div class="flex items-center justify-between text-sm text-gray-500">
      <% if content_item.source.present? %>
        <span class="truncate max-w-[50%]" title="<%= content_item.source.name %>">
          <%= content_item.source.name %>
        </span>
      <% else %>
        <span></span>
      <% end %>

      <div class="flex items-center gap-3">
        <% if content_item.upvotes_count.to_i > 0 %>
          <span class="flex items-center gap-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/>
            </svg>
            <%= content_item.upvotes_count %>
          </span>
        <% end %>
        <% if content_item.comments_count.to_i > 0 %>
          <span class="flex items-center gap-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
            </svg>
            <%= content_item.comments_count %>
          </span>
        <% end %>
      </div>
    </div>
  </div>
</article>
