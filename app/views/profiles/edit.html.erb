<% content_for :title, t('profiles.edit_title') %>

<div class="container mx-auto px-4 py-8 max-w-2xl">
  <h1 class="text-3xl font-bold text-gray-900 mb-6">
    <%= t('profiles.edit_title') %>
  </h1>

  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
    <%= form_with model: @user, url: profile_path(@user), method: :patch, class: "space-y-6" do |f| %>
      <% if @user.errors.any? %>
        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
          <h3 class="text-red-800 font-medium"><%= t('errors.form_errors', count: @user.errors.count) %></h3>
          <ul class="mt-2 text-sm text-red-700 list-disc list-inside">
            <% @user.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <%# Avatar Preview %>
      <div class="flex items-center gap-6">
        <div class="flex-shrink-0">
          <% if @user.avatar_url.present? %>
            <%= image_tag @user.avatar_url, alt: @user.profile_name, class: "w-20 h-20 rounded-full object-cover", id: "avatar-preview" %>
          <% else %>
            <div class="w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center" id="avatar-preview-initials">
              <span class="text-xl font-bold text-blue-600"><%= @user.initials %></span>
            </div>
          <% end %>
        </div>
        <div class="flex-1">
          <%= f.label :avatar_url, class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= f.text_field :avatar_url, class: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500", placeholder: "https://example.com/avatar.jpg" %>
          <p class="mt-1 text-xs text-gray-500"><%= t('profiles.form.avatar_hint') %></p>
        </div>
      </div>

      <%# Display Name %>
      <div>
        <%= f.label :display_name, class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :display_name, class: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500", maxlength: 50, placeholder: t('profiles.form.display_name_placeholder') %>
        <p class="mt-1 text-xs text-gray-500"><%= t('profiles.form.display_name_hint') %></p>
      </div>

      <%# Bio %>
      <div>
        <%= f.label :bio, class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_area :bio, class: "w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500", rows: 4, maxlength: 500, placeholder: t('profiles.form.bio_placeholder') %>
        <p class="mt-1 text-xs text-gray-500"><%= t('profiles.form.bio_hint') %></p>
      </div>

      <%# Actions %>
      <div class="flex items-center justify-between pt-4 border-t border-gray-200">
        <%= link_to t('common.cancel'), profile_path(@user), class: "text-gray-600 hover:text-gray-800" %>
        <%= f.submit t('profiles.form.save'), class: "px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors cursor-pointer" %>
      </div>
    <% end %>
  </div>
</div>
