<%# Checkout options for listing payments %>
<% content_for :head do %>
  <%= set_meta_tags(
    title: t("checkouts.title"),
    description: t("checkouts.description")
  ) %>
<% end %>

<div class="max-w-4xl mx-auto px-4 py-12">
  <div class="mb-8">
    <%= link_to listing_path(@entry), class: "text-blue-600 hover:text-blue-700 inline-flex items-center gap-1" do %>
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
      <%= t("actions.back") %>
    <% end %>
  </div>

  <div class="bg-white rounded-lg shadow-lg overflow-hidden">
    <div class="px-6 py-8 border-b border-gray-200">
      <h1 class="text-2xl font-bold text-gray-900"><%= t("checkouts.title") %></h1>
      <p class="mt-2 text-gray-600"><%= t("checkouts.subtitle") %></p>

      <div class="mt-4 p-4 bg-gray-50 rounded-lg">
        <h2 class="font-semibold text-gray-900"><%= @entry.title %></h2>
        <p class="text-sm text-gray-600"><%= @entry.description&.truncate(100) %></p>
      </div>
    </div>

    <div class="p-6">
      <% if @entry.category&.category_type == "job" %>
        <h3 class="text-lg font-semibold text-gray-900 mb-4"><%= t("checkouts.job_posting_options") %></h3>
        <div class="grid md:grid-cols-3 gap-4 mb-8">
          <% @checkout_options.select { |o| o[:type].to_s.start_with?("job_post") }.each do |option| %>
            <%= form_with url: listing_checkout_path(@entry), method: :post, class: "block" do |f| %>
              <%= f.hidden_field :checkout_type, value: option[:type] %>
              <button type="submit" class="w-full p-6 bg-white border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:shadow-md transition-all text-left group">
                <div class="text-2xl font-bold text-gray-900 group-hover:text-blue-600">
                  <%= number_to_currency(option[:config][:amount] / 100.0) %>
                </div>
                <div class="font-semibold text-gray-700 mt-1"><%= option[:config][:name] %></div>
                <div class="text-sm text-gray-500 mt-1"><%= option[:config][:description] %></div>
              </button>
            <% end %>
          <% end %>
        </div>
      <% end %>

      <h3 class="text-lg font-semibold text-gray-900 mb-4"><%= t("checkouts.featured_options") %></h3>
      <div class="grid md:grid-cols-3 gap-4">
        <% @checkout_options.select { |o| o[:type].to_s.start_with?("featured") }.each do |option| %>
          <%= form_with url: listing_checkout_path(@entry), method: :post, class: "block" do |f| %>
            <%= f.hidden_field :checkout_type, value: option[:type] %>
            <button type="submit" class="w-full p-6 bg-white border-2 border-gray-200 rounded-lg hover:border-yellow-500 hover:shadow-md transition-all text-left group">
              <div class="text-2xl font-bold text-gray-900 group-hover:text-yellow-600">
                <%= number_to_currency(option[:config][:amount] / 100.0) %>
              </div>
              <div class="font-semibold text-gray-700 mt-1"><%= option[:config][:name] %></div>
              <div class="text-sm text-gray-500 mt-1"><%= option[:config][:description] %></div>
            </button>
          <% end %>
        <% end %>
      </div>

      <div class="mt-8 p-4 bg-blue-50 rounded-lg">
        <div class="flex items-start gap-3">
          <svg class="w-5 h-5 text-blue-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          <div>
            <h4 class="font-semibold text-blue-900"><%= t("checkouts.secure_payment") %></h4>
            <p class="text-sm text-blue-700"><%= t("checkouts.secure_payment_description") %></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
