#!/usr/bin/env bash
#
# bin/agent - Claude Agent Wrapper
#
# This is a convenience wrapper that calls the main agent script.
# The actual implementation lives in .claude/agent/
#
# Usage:
#   ./bin/agent        # Run 5 tasks (default)
#   ./bin/agent 3      # Run 3 tasks
#   ./bin/agent 1      # Run 1 task
#
# Parallel usage:
#   AGENT_NAME="worker-1" ./bin/agent 5 &
#   AGENT_NAME="worker-2" ./bin/agent 5 &
#
# Environment variables:
#   CLAUDE_MODEL       - Model to use (default: opus)
#   AGENT_DRY_RUN      - Preview without executing (default: 0)
#   AGENT_PROGRESS     - Show progress updates (default: 1)
#   AGENT_QUIET        - Disable all output (default: 0)
#
# See .claude/agent/README.md for full documentation.
#
set -euo pipefail

# Find the project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_DIR="$(cd "$SCRIPT_DIR/.." && pwd)"

# Check if agent is installed
AGENT_SCRIPT="$PROJECT_DIR/.claude/agent/run.sh"
if [ ! -f "$AGENT_SCRIPT" ]; then
  echo "Error: Claude Agent not found at $AGENT_SCRIPT"
  echo ""
  echo "To install the agent system:"
  echo "  1. Copy .claude/agent/ from a project that has it"
  echo "  2. Or run: curl -sSL https://example.com/install.sh | bash"
  exit 1
fi

# Delegate to the main agent script
exec "$AGENT_SCRIPT" "$@"
